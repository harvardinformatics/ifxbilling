BillingRecords
===============

This document describes the details of BillingRecords.

BillingRecords are pre-invoice line items for review purposes
-------------------------------------------------------------
BillingRecords are designed to provide users, lab admins, and facility administrators
a preview of invoice line items.  These can be modified in various ways and, unlike
Invoices, BillingRecord values may change over time, if, for example, a product name
changes.

BillingRecords are tied to a single Account
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
BillingRecords combine a ProductUsage a "charge" and an Account.  If multiple
Accounts must be used to pay a charge, that will result in multiple BillingRecords

BillingRecord charges are a function of Transactions
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
The BillingRecord API prevents the charge field on a BillingRecord from being
directly updated.  Instead, it is calculated from the combination of Transaction records
associated with it.  The calculation is done via the Transaction post save trigger.

Transaction updates should also be blocked, but they currently aren't.

BillingRecords are generated by "calculators"
---------------------------------------------
The BasicBillingCalculator looks at ProductUsage records and Product Rates and performs a simple
multiplication of rate and "quantity" of units.

